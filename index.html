<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pocket PRC Tool - Keller Williams</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        @media print {
            body {
                margin: 0;
                padding: 0;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            @page {
                size: letter;
                margin: 0.25in;
            }
            
            .no-print {
                display: none !important;
            }
            
            .print-container {
                padding: 0 !important;
                max-width: 100% !important;
                page-break-inside: avoid;
            }
            
            .form-border {
                border: 1.5px solid black;
                page-break-inside: avoid;
            }
            
            .section-header {
                background-color: #dc2626 !important;
                color: white !important;
                padding: 1px 4px;
                font-size: 9px;
                line-height: 1.2;
            }
            
            .section-header h1 {
                font-size: 9px;
                margin: 0;
                line-height: 1.2;
            }
            
            .section-header p {
                font-size: 7px;
                margin: 0;
                line-height: 1.2;
            }
            
            .section-title {
                background-color: #f3f4f6 !important;
                padding: 1px 4px;
                font-weight: bold;
                font-size: 7.5px;
                line-height: 1.1;
                border-bottom: 1px solid black;
            }
            
            .section-content {
                padding: 1px 4px;
                font-size: 6.5px;
                line-height: 1.15;
                border-bottom: 1px solid black;
            }
            
            .section-content p {
                margin-top: 0px;
                margin-bottom: 1px;
            }
            
            .section-content label {
                font-size: 6.5px;
            }
            
            .section-content input[type="checkbox"] {
                width: 8px;
                height: 8px;
            }
            
            .kw-logo {
                background-color: white !important;
                color: #dc2626 !important;
                padding: 1px 3px;
                font-size: 9px;
            }
            
            .permits-area {
                min-height: 10px !important;
                font-size: 6.5px;
            }
            
            .attachment-page {
                page-break-before: always;
                page-break-inside: avoid;
                margin: 0;
                padding: 0.25in;
            }
            
            .attachment-image {
                max-width: 100%;
                max-height: 9.5in;
                height: auto;
                width: auto;
                margin: 0 auto;
                display: block;
                object-fit: contain;
            }
            
            /* Additional mobile Safari optimizations */
            @supports (-webkit-touch-callout: none) {
                .form-border {
                    page-break-inside: avoid !important;
                    -webkit-column-break-inside: avoid !important;
                }
                
                .attachment-page {
                    page-break-inside: avoid !important;
                    -webkit-column-break-inside: avoid !important;
                }
            }
        }
        
        @media screen {
            .print-only {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Set up PDF.js worker
        if (typeof pdfjsLib !== 'undefined') {
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        }

        const Printer = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="6 9 6 2 18 2 18 9"></polyline>
                <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                <rect x="6" y="14" width="12" height="8"></rect>
            </svg>
        );

        const Edit = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
            </svg>
        );

        const Home = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
        );

        const FileText = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
        );

        const Save = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                <polyline points="17 21 17 13 7 13 7 21"></polyline>
                <polyline points="7 3 7 8 15 8"></polyline>
            </svg>
        );

        const Upload = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="17 8 12 3 7 8"></polyline>
                <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
        );

        const Paperclip = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48"></path>
            </svg>
        );

        const Trash = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            </svg>
        );

        function PocketPRCTool() {
            const [mode, setMode] = useState('edit');
            const [isProcessing, setIsProcessing] = useState(false);
            const [formData, setFormData] = useState({
                propertyAddress: '',
                homesteadExemption: false,
                homesteadAmount: '',
                veteransExemption: false,
                veteransAmount: '',
                treeGrowthExemption: false,
                treeGrowthAmount: '',
                noExemptions: false,
                propertyDataCard: false,
                taxMap: false,
                dateVisited: '',
                currentZoning: '',
                floodZone: '',
                zoningOverlay: '',
                conformsToZoning: '',
                dwellingUnits: '',
                septicInShoreland: '',
                permitsDescription: '',
                codeEnforcementDocs: false,
                zoneOverlays: false,
                recordedSurvey: false,
                easements: false,
                associationDocs: false,
                associationFinancials: false,
                condoCertificate: false,
                septicDesign: false,
                completedBy: '',
                attachments: []
            });

            const handleChange = (field, value) => {
                setFormData(prev => ({ ...prev, [field]: value }));
            };

            const handlePrint = () => {
                window.print();
            };

            const handleSave = () => {
                const dataStr = JSON.stringify(formData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                
                let filename = formData.propertyAddress 
                    ? formData.propertyAddress.replace(/[^a-z0-9]/gi, '_').toLowerCase() 
                    : 'prc_checklist';
                filename = filename + '.json';
                
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
            };

            const handleLoad = (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const data = JSON.parse(e.target.result);
                            // Ensure attachments array exists
                            if (!data.attachments) {
                                data.attachments = [];
                            }
                            setFormData(data);
                        } catch (error) {
                            console.error('Error loading JSON:', error);
                            alert('Error loading file. Please make sure it is a valid PRC JSON file.');
                        }
                    };
                    reader.onerror = () => {
                        alert('Error reading file. Please try again.');
                    };
                    reader.readAsText(file);
                }
                // Reset the file input
                event.target.value = '';
            };

            const convertPdfToImages = async (file) => {
                try {
                    const arrayBuffer = await file.arrayBuffer();
                    const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
                    const images = [];
                    
                    for (let i = 1; i <= pdf.numPages; i++) {
                        try {
                            const page = await pdf.getPage(i);
                            const viewport = page.getViewport({ scale: 1.5 });
                            const canvas = document.createElement('canvas');
                            const context = canvas.getContext('2d');
                            canvas.height = viewport.height;
                            canvas.width = viewport.width;
                            
                            await page.render({ canvasContext: context, viewport: viewport }).promise;
                            images.push({
                                data: canvas.toDataURL('image/jpeg', 0.85),
                                name: `${file.name} - Page ${i}`,
                                type: 'image/jpeg'
                            });
                        } catch (pageError) {
                            console.error(`Error processing page ${i}:`, pageError);
                            // Continue with other pages
                        }
                    }
                    
                    if (images.length === 0) {
                        throw new Error('No pages could be processed from PDF');
                    }
                    
                    return images;
                } catch (error) {
                    console.error('Error converting PDF:', error);
                    throw error;
                }
            };

            const handleFileUpload = async (event) => {
                const files = Array.from(event.target.files);
                if (files.length === 0) return;
                
                // Prevent multiple simultaneous uploads
                if (isProcessing) return;
                
                setIsProcessing(true);
                const newAttachments = [];
                
                try {
                    for (const file of files) {
                        try {
                            if (file.type === 'application/pdf') {
                                const pdfImages = await convertPdfToImages(file);
                                newAttachments.push(...pdfImages);
                            } else if (file.type.startsWith('image/')) {
                                const reader = new FileReader();
                                const dataUrl = await new Promise((resolve, reject) => {
                                    reader.onload = (e) => resolve(e.target.result);
                                    reader.onerror = (e) => reject(e);
                                    reader.readAsDataURL(file);
                                });
                                newAttachments.push({
                                    data: dataUrl,
                                    name: file.name,
                                    type: file.type
                                });
                            }
                        } catch (fileError) {
                            console.error(`Error processing ${file.name}:`, fileError);
                            alert(`Could not process ${file.name}. Skipping this file.`);
                        }
                    }
                    
                    if (newAttachments.length > 0) {
                        setFormData(prev => ({
                            ...prev,
                            attachments: [...(prev.attachments || []), ...newAttachments]
                        }));
                    }
                } catch (error) {
                    console.error('Error uploading files:', error);
                    alert('Error uploading files. Please try again.');
                } finally {
                    setIsProcessing(false);
                    event.target.value = '';
                }
            };

            const removeAttachment = (index) => {
                setFormData(prev => ({
                    ...prev,
                    attachments: (prev.attachments || []).filter((_, i) => i !== index)
                }));
            };

            const formatDateForDisplay = (dateString) => {
                if (!dateString) return '_______________';
                const date = new Date(dateString);
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                const year = date.getFullYear();
                return `${month}/${day}/${year}`;
            };

            if (mode === 'preview') {
                return (
                    <div className="min-h-screen bg-white">
                        <div className="no-print bg-red-600 text-white p-4 flex justify-between items-center sticky top-0 z-10">
                            <h1 className="text-xl font-bold">Preview Mode</h1>
                            <div className="flex gap-2">
                                <button
                                    onClick={() => setMode('edit')}
                                    className="bg-white text-red-600 px-4 py-2 rounded flex items-center gap-2"
                                >
                                    <Edit size={18} />
                                    Edit
                                </button>
                                <button
                                    onClick={handlePrint}
                                    className="bg-white text-red-600 px-4 py-2 rounded flex items-center gap-2"
                                >
                                    <Printer size={18} />
                                    Print
                                </button>
                            </div>
                        </div>

                        <div className="print-container max-w-4xl mx-auto p-8">
                            <div className="form-border border-4 border-black" style={{pageBreakInside: 'avoid'}}>
                                {/* Header */}
                                <div className="section-header bg-red-600 text-white p-4 flex items-center gap-4">
                                    <div className="kw-logo bg-white text-red-600 font-bold text-2xl px-3 py-2" style={{fontSize: '1.5rem', padding: '0.25rem 0.5rem'}}>kw</div>
                                    <div>
                                        <h1 className="text-2xl font-bold" style={{fontSize: '1.25rem', margin: 0}}>PUBLIC RECORD CHECKLIST</h1>
                                        <p className="text-sm" style={{fontSize: '0.75rem', margin: 0}}>Property Address: {formData.propertyAddress || '_______________'}</p>
                                    </div>
                                </div>

                                {/* Section 1 */}
                                <div className="border-t-2 border-black">
                                    <div className="section-title bg-gray-100 p-3 font-bold border-b-2 border-black">
                                        1. ASSESSOR'S OFFICE
                                    </div>
                                    <div className="section-content p-3 border-b-2 border-black">
                                        <p className="mb-2">Any Tax Exemptions?</p>
                                        <div className="flex flex-wrap gap-4">
                                            <label className="flex items-center gap-2">
                                                <input type="checkbox" checked={formData.homesteadExemption} readOnly />
                                                Homestead ${formData.homesteadAmount || '______'}
                                            </label>
                                            <label className="flex items-center gap-2">
                                                <input type="checkbox" checked={formData.veteransExemption} readOnly />
                                                Veterans ${formData.veteransAmount || '______'}
                                            </label>
                                            <label className="flex items-center gap-2">
                                                <input type="checkbox" checked={formData.treeGrowthExemption} readOnly />
                                                Tree Growth ${formData.treeGrowthAmount || '______'}
                                            </label>
                                            <label className="flex items-center gap-2">
                                                <input type="checkbox" checked={formData.noExemptions} readOnly />
                                                N/A
                                            </label>
                                        </div>
                                    </div>
                                    <div className="section-content p-3 border-b-2 border-black">
                                        <label className="flex items-center gap-2">
                                            <input type="checkbox" checked={formData.propertyDataCard} readOnly />
                                            ATTACH Property Data Card - required
                                        </label>
                                    </div>
                                    <div className="section-content p-3 border-b-2 border-black">
                                        <label className="flex items-center gap-2">
                                            <input type="checkbox" checked={formData.taxMap} readOnly />
                                            ATTACH Tax Map - required
                                        </label>
                                    </div>
                                </div>

                                {/* Section 2 */}
                                <div className="border-t-2 border-black">
                                    <div className="section-title bg-gray-100 p-3 font-bold border-b-2 border-black flex justify-between">
                                        <span>2. CODE ENFORCEMENT OFFICE</span>
                                        <span>DATE VISITED: {formatDateForDisplay(formData.dateVisited)}</span>
                                    </div>
                                    <div className="section-content p-3 border-b-2 border-black">
                                        <p>1. Current Zoning: {formData.currentZoning || '_______________'}</p>
                                        <p>
                                            Flood Zone? 
                                            <label className="ml-2"><input type="checkbox" checked={formData.floodZone === 'Yes'} readOnly /> Yes</label>
                                            <label className="ml-2"><input type="checkbox" checked={formData.floodZone === 'No'} readOnly /> No</label>
                                            <span className="ml-4">Zoning Overlay? {formData.zoningOverlay || '_______________'}</span>
                                        </p>
                                    </div>
                                    <div className="section-content p-3 border-b-2 border-black">
                                        <p>2. Does current use appear to conform to zoning restrictions?</p>
                                        <p>{formData.conformsToZoning || '_______________'}</p>
                                    </div>
                                    <div className="section-content p-3 border-b-2 border-black">
                                        <p>3. Number of legal dwelling units permitted per ordinance?</p>
                                        <p>{formData.dwellingUnits || '_______________'}</p>
                                    </div>
                                    <div className="section-content p-3 border-b-2 border-black">
                                        <p>4. Septic system located in a shoreland zone?</p>
                                        <p>
                                            <label className="ml-2"><input type="checkbox" checked={formData.septicInShoreland === 'Yes'} readOnly /> Yes</label>
                                            <label className="ml-2"><input type="checkbox" checked={formData.septicInShoreland === 'No'} readOnly /> No</label>
                                            <label className="ml-2"><input type="checkbox" checked={formData.septicInShoreland === 'N/A'} readOnly /> N/A</label>
                                        </p>
                                    </div>
                                    <div className="section-content p-3 border-b-2 border-black">
                                        <p className="font-semibold">5. Record dates & descriptions of permits issued or code enforcement issues, if any. DO NOT LEAVE BLANK</p>
                                        <p className="permits-area whitespace-pre-wrap">{formData.permitsDescription || ''}</p>
                                    </div>
                                </div>

                                {/* Section 3 */}
                                <div className="border-t-2 border-black">
                                    <div className="section-title bg-gray-100 p-3 font-bold border-b-2 border-black">
                                        3. SUBMIT THE FOLLOWING DOCUMENTS <em>IF APPLICABLE:</em>
                                    </div>
                                    <div className="section-content p-3 border-b-2 border-black">
                                        <label className="flex items-center gap-2">
                                            <input type="checkbox" checked={formData.codeEnforcementDocs} readOnly />
                                            Pertinent code enforcement file documents (from section 2 item 5 above)
                                        </label>
                                    </div>
                                    <div className="section-content p-3 border-b-2 border-black">
                                        <label className="flex items-center gap-2">
                                            <input type="checkbox" checked={formData.zoneOverlays} readOnly />
                                            Zone Overlays (from section 2 item 1 above)
                                        </label>
                                    </div>
                                    <div className="section-content p-3 border-b-2 border-black">
                                        <label className="flex items-center gap-2">
                                            <input type="checkbox" checked={formData.recordedSurvey} readOnly />
                                            Recorded survey (if deed only references a plan to describe the property)
                                        </label>
                                    </div>
                                    <div className="section-content p-3 border-b-2 border-black">
                                        <label className="flex items-center gap-2">
                                            <input type="checkbox" checked={formData.easements} readOnly />
                                            Recorded easements, restrictions, covenants or subdivision plan restrictions
                                        </label>
                                    </div>
                                    <div className="section-content p-3 border-b-2 border-black">
                                        <label className="flex items-center gap-2">
                                            <input type="checkbox" checked={formData.associationDocs} readOnly />
                                            Association declarations, bylaws, rules/regs
                                        </label>
                                    </div>
                                    <div className="section-content p-3 border-b-2 border-black">
                                        <label className="flex items-center gap-2">
                                            <input type="checkbox" checked={formData.associationFinancials} readOnly />
                                            Association financial statements
                                        </label>
                                    </div>
                                    <div className="section-content p-3 border-b-2 border-black">
                                        <label className="flex items-center gap-2">
                                            <input type="checkbox" checked={formData.condoCertificate} readOnly />
                                            Condominium resale certificate or public offering statement
                                        </label>
                                    </div>
                                    <div className="section-content p-3 border-b-2 border-black">
                                        <label className="flex items-center gap-2">
                                            <input type="checkbox" checked={formData.septicDesign} readOnly />
                                            Septic Design (HHE 200)
                                        </label>
                                    </div>
                                </div>

                                {/* Section 4 */}
                                <div className="border-t-2 border-black">
                                    <div className="section-content p-3 flex justify-between items-center">
                                        <div>
                                            <strong>4. COMPLETED BY:</strong> {formData.completedBy || '_______________________________________________'}
                                        </div>
                                        <div className="text-sm text-gray-600">Rev. 5.18</div>
                                    </div>
                                </div>
                            </div>

                            {/* Attachments */}
                            {formData.attachments && formData.attachments.length > 0 && (
                                formData.attachments.map((attachment, index) => (
                                    <div key={index} className="attachment-page" style={{pageBreakBefore: 'always', pageBreakInside: 'avoid'}}>
                                        <div className="text-center mb-4 no-print">
                                            <h2 className="text-lg font-bold">Attachment {index + 1}: {attachment.name}</h2>
                                        </div>
                                        <div style={{pageBreakInside: 'avoid'}}>
                                            <img 
                                                src={attachment.data} 
                                                alt={attachment.name}
                                                className="attachment-image"
                                                style={{maxWidth: '100%', maxHeight: '9.5in', height: 'auto', width: 'auto', display: 'block', margin: '0 auto'}}
                                            />
                                        </div>
                                    </div>
                                ))
                            )}
                        </div>
                    </div>
                );
            }

            // Edit Mode
            return (
                <div className="min-h-screen bg-gray-50">
                    <div className="bg-red-600 text-white p-4 sticky top-0 z-10 shadow-lg">
                        <div className="max-w-2xl mx-auto flex justify-between items-center">
                            <h1 className="text-xl font-bold flex items-center gap-2">
                                <Home size={24} />
                                Pocket PRC Tool
                            </h1>
                            <div className="flex gap-2">
                                <button
                                    onClick={handleSave}
                                    className="bg-white text-red-600 px-3 py-2 rounded font-semibold flex items-center gap-2"
                                >
                                    <Save size={18} />
                                    <span className="hidden sm:inline">Save</span>
                                </button>
                                <label className="bg-white text-red-600 px-3 py-2 rounded font-semibold flex items-center gap-2 cursor-pointer">
                                    <Upload size={18} />
                                    <span className="hidden sm:inline">Load</span>
                                    <input
                                        type="file"
                                        accept=".json"
                                        onChange={handleLoad}
                                        className="hidden"
                                    />
                                </label>
                                <button
                                    onClick={() => setMode('preview')}
                                    className="bg-white text-red-600 px-3 py-2 rounded font-semibold flex items-center gap-2"
                                >
                                    <FileText size={18} />
                                    <span className="hidden sm:inline">Preview</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div className="max-w-2xl mx-auto p-4 pb-20">
                        <div className="bg-white rounded-lg shadow p-4 mb-4">
                            <label className="block font-semibold mb-2">Property Address</label>
                            <input
                                type="text"
                                value={formData.propertyAddress}
                                onChange={(e) => handleChange('propertyAddress', e.target.value)}
                                className="w-full border rounded px-3 py-2"
                                placeholder="123 Main Street, City, State ZIP"
                            />
                        </div>

                        <div className="bg-white rounded-lg shadow p-4 mb-4">
                            <h2 className="text-lg font-bold mb-4 text-red-600">1. ASSESSOR'S OFFICE</h2>
                            
                            <div className="mb-4">
                                <p className="font-semibold mb-2">Tax Exemptions:</p>
                                <label className="flex items-center gap-2 mb-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.homesteadExemption}
                                        onChange={(e) => handleChange('homesteadExemption', e.target.checked)}
                                        className="w-5 h-5"
                                    />
                                    <span>Homestead</span>
                                    <input
                                        type="text"
                                        value={formData.homesteadAmount}
                                        onChange={(e) => handleChange('homesteadAmount', e.target.value)}
                                        placeholder="Amount"
                                        className="border rounded px-2 py-1 w-24"
                                    />
                                </label>
                                <label className="flex items-center gap-2 mb-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.veteransExemption}
                                        onChange={(e) => handleChange('veteransExemption', e.target.checked)}
                                        className="w-5 h-5"
                                    />
                                    <span>Veterans</span>
                                    <input
                                        type="text"
                                        value={formData.veteransAmount}
                                        onChange={(e) => handleChange('veteransAmount', e.target.value)}
                                        placeholder="Amount"
                                        className="border rounded px-2 py-1 w-24"
                                    />
                                </label>
                                <label className="flex items-center gap-2 mb-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.treeGrowthExemption}
                                        onChange={(e) => handleChange('treeGrowthExemption', e.target.checked)}
                                        className="w-5 h-5"
                                    />
                                    <span>Tree Growth</span>
                                    <input
                                        type="text"
                                        value={formData.treeGrowthAmount}
                                        onChange={(e) => handleChange('treeGrowthAmount', e.target.value)}
                                        placeholder="Amount"
                                        className="border rounded px-2 py-1 w-24"
                                    />
                                </label>
                                <label className="flex items-center gap-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.noExemptions}
                                        onChange={(e) => handleChange('noExemptions', e.target.checked)}
                                        className="w-5 h-5"
                                    />
                                    <span>N/A (No exemptions)</span>
                                </label>
                            </div>

                            <div className="space-y-2">
                                <label className="flex items-center gap-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.propertyDataCard}
                                        onChange={(e) => handleChange('propertyDataCard', e.target.checked)}
                                        className="w-5 h-5"
                                    />
                                    <span>Property Data Card attached (required)</span>
                                </label>
                                <label className="flex items-center gap-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.taxMap}
                                        onChange={(e) => handleChange('taxMap', e.target.checked)}
                                        className="w-5 h-5"
                                    />
                                    <span>Tax Map attached (required)</span>
                                </label>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow p-4 mb-4">
                            <h2 className="text-lg font-bold mb-4 text-red-600">2. CODE ENFORCEMENT OFFICE</h2>
                            
                            <div className="mb-4">
                                <label className="block font-semibold mb-2">Date Visited</label>
                                <input
                                    type="date"
                                    value={formData.dateVisited}
                                    onChange={(e) => handleChange('dateVisited', e.target.value)}
                                    className="w-full border rounded px-3 py-2"
                                />
                            </div>

                            <div className="mb-4">
                                <label className="block font-semibold mb-2">Current Zoning</label>
                                <input
                                    type="text"
                                    value={formData.currentZoning}
                                    onChange={(e) => handleChange('currentZoning', e.target.value)}
                                    className="w-full border rounded px-3 py-2"
                                    placeholder="e.g., R-1, Commercial, etc."
                                />
                            </div>

                            <div className="mb-4">
                                <label className="block font-semibold mb-2">Flood Zone?</label>
                                <div className="flex gap-4">
                                    <label className="flex items-center gap-2">
                                        <input
                                            type="radio"
                                            name="floodZone"
                                            checked={formData.floodZone === 'Yes'}
                                            onChange={() => handleChange('floodZone', 'Yes')}
                                            className="w-5 h-5"
                                        />
                                        Yes
                                    </label>
                                    <label className="flex items-center gap-2">
                                        <input
                                            type="radio"
                                            name="floodZone"
                                            checked={formData.floodZone === 'No'}
                                            onChange={() => handleChange('floodZone', 'No')}
                                            className="w-5 h-5"
                                        />
                                        No
                                    </label>
                                </div>
                            </div>

                            <div className="mb-4">
                                <label className="block font-semibold mb-2">Zoning Overlay?</label>
                                <input
                                    type="text"
                                    value={formData.zoningOverlay}
                                    onChange={(e) => handleChange('zoningOverlay', e.target.value)}
                                    className="w-full border rounded px-3 py-2"
                                    placeholder="If applicable"
                                />
                            </div>

                            <div className="mb-4">
                                <label className="block font-semibold mb-2">
                                    Does current use appear to conform to zoning restrictions?
                                </label>
                                <input
                                    type="text"
                                    value={formData.conformsToZoning}
                                    onChange={(e) => handleChange('conformsToZoning', e.target.value)}
                                    className="w-full border rounded px-3 py-2"
                                    placeholder="Yes/No and explanation"
                                />
                            </div>

                            <div className="mb-4">
                                <label className="block font-semibold mb-2">
                                    Number of legal dwelling units permitted per ordinance?
                                </label>
                                <input
                                    type="text"
                                    value={formData.dwellingUnits}
                                    onChange={(e) => handleChange('dwellingUnits', e.target.value)}
                                    className="w-full border rounded px-3 py-2"
                                    placeholder="e.g., 1, 2, etc."
                                />
                            </div>

                            <div className="mb-4">
                                <label className="block font-semibold mb-2">
                                    Septic system located in a shoreland zone?
                                </label>
                                <div className="flex gap-4">
                                    <label className="flex items-center gap-2">
                                        <input
                                            type="radio"
                                            name="septicInShoreland"
                                            checked={formData.septicInShoreland === 'Yes'}
                                            onChange={() => handleChange('septicInShoreland', 'Yes')}
                                            className="w-5 h-5"
                                        />
                                        Yes
                                    </label>
                                    <label className="flex items-center gap-2">
                                        <input
                                            type="radio"
                                            name="septicInShoreland"
                                            checked={formData.septicInShoreland === 'No'}
                                            onChange={() => handleChange('septicInShoreland', 'No')}
                                            className="w-5 h-5"
                                        />
                                        No
                                    </label>
                                    <label className="flex items-center gap-2">
                                        <input
                                            type="radio"
                                            name="septicInShoreland"
                                            checked={formData.septicInShoreland === 'N/A'}
                                            onChange={() => handleChange('septicInShoreland', 'N/A')}
                                            className="w-5 h-5"
                                        />
                                        N/A
                                    </label>
                                </div>
                            </div>

                            <div className="mb-4">
                                <label className="block font-semibold mb-2">
                                    Permits issued or code enforcement issues (DO NOT LEAVE BLANK)
                                </label>
                                <textarea
                                    value={formData.permitsDescription}
                                    onChange={(e) => handleChange('permitsDescription', e.target.value)}
                                    className="w-full border rounded px-3 py-2"
                                    rows="4"
                                    placeholder="Record dates and descriptions, or write 'None' if not applicable"
                                />
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow p-4 mb-4">
                            <h2 className="text-lg font-bold mb-4 text-red-600">
                                3. DOCUMENTS TO SUBMIT <span className="text-sm italic">(if applicable)</span>
                            </h2>
                            
                            <div className="space-y-3">
                                <label className="flex items-start gap-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.codeEnforcementDocs}
                                        onChange={(e) => handleChange('codeEnforcementDocs', e.target.checked)}
                                        className="w-5 h-5 mt-0.5"
                                    />
                                    <span>Code enforcement file documents</span>
                                </label>
                                <label className="flex items-start gap-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.zoneOverlays}
                                        onChange={(e) => handleChange('zoneOverlays', e.target.checked)}
                                        className="w-5 h-5 mt-0.5"
                                    />
                                    <span>Zone Overlays</span>
                                </label>
                                <label className="flex items-start gap-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.recordedSurvey}
                                        onChange={(e) => handleChange('recordedSurvey', e.target.checked)}
                                        className="w-5 h-5 mt-0.5"
                                    />
                                    <span>Recorded survey</span>
                                </label>
                                <label className="flex items-start gap-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.easements}
                                        onChange={(e) => handleChange('easements', e.target.checked)}
                                        className="w-5 h-5 mt-0.5"
                                    />
                                    <span>Recorded easements, restrictions, covenants</span>
                                </label>
                                <label className="flex items-start gap-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.associationDocs}
                                        onChange={(e) => handleChange('associationDocs', e.target.checked)}
                                        className="w-5 h-5 mt-0.5"
                                    />
                                    <span>Association declarations, bylaws, rules/regs</span>
                                </label>
                                <label className="flex items-start gap-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.associationFinancials}
                                        onChange={(e) => handleChange('associationFinancials', e.target.checked)}
                                        className="w-5 h-5 mt-0.5"
                                    />
                                    <span>Association financial statements</span>
                                </label>
                                <label className="flex items-start gap-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.condoCertificate}
                                        onChange={(e) => handleChange('condoCertificate', e.target.checked)}
                                        className="w-5 h-5 mt-0.5"
                                    />
                                    <span>Condominium resale certificate</span>
                                </label>
                                <label className="flex items-start gap-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.septicDesign}
                                        onChange={(e) => handleChange('septicDesign', e.target.checked)}
                                        className="w-5 h-5 mt-0.5"
                                    />
                                    <span>Septic Design (HHE 200)</span>
                                </label>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow p-4 mb-4">
                            <h2 className="text-lg font-bold mb-4 text-red-600">4. COMPLETED BY</h2>
                            <input
                                type="text"
                                value={formData.completedBy}
                                onChange={(e) => handleChange('completedBy', e.target.value)}
                                className="w-full border rounded px-3 py-2"
                                placeholder="Your name"
                            />
                        </div>

                        {/* Attachments Section */}
                        <div className="bg-white rounded-lg shadow p-4 mb-4">
                            <h2 className="text-lg font-bold mb-4 text-red-600 flex items-center gap-2">
                                <Paperclip size={24} />
                                Attachments
                            </h2>
                            
                            <label className={`w-full px-4 py-3 rounded font-semibold flex items-center justify-center gap-2 cursor-pointer transition ${
                                isProcessing 
                                    ? 'bg-gray-400 cursor-not-allowed' 
                                    : 'bg-red-600 text-white hover:bg-red-700'
                            }`}>
                                <Paperclip size={20} />
                                {isProcessing ? 'Processing Files...' : 'Add Photos or PDFs'}
                                <input
                                    type="file"
                                    accept="image/*,.pdf"
                                    multiple
                                    onChange={handleFileUpload}
                                    disabled={isProcessing}
                                    className="hidden"
                                />
                            </label>
                            
                            {isProcessing && (
                                <div className="mt-4 p-4 bg-blue-50 border border-blue-200 rounded text-center">
                                    <p className="text-blue-700 font-semibold">Processing your files...</p>
                                    <p className="text-sm text-blue-600 mt-1">Please wait, this may take a moment for PDFs</p>
                                </div>
                            )}
                            
                            <p className="text-sm text-gray-600 mt-2 text-center">
                                Upload images or PDFs - they'll be included in your printed document
                            </p>

                            {formData.attachments && formData.attachments.length > 0 && (
                                <div className="mt-4 space-y-2">
                                    <h3 className="font-semibold">Attached Files ({formData.attachments.length}):</h3>
                                    {formData.attachments.map((attachment, index) => (
                                        <div key={index} className="flex items-center justify-between p-2 bg-gray-50 rounded border">
                                            <div className="flex items-center gap-2 flex-1 min-w-0">
                                                <img 
                                                    src={attachment.data} 
                                                    alt={attachment.name}
                                                    className="w-12 h-12 object-cover rounded"
                                                />
                                                <span className="text-sm truncate">{attachment.name}</span>
                                            </div>
                                            <button
                                                onClick={() => removeAttachment(index)}
                                                className="text-red-600 hover:text-red-800 p-2"
                                            >
                                                <Trash size={20} />
                                            </button>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<PocketPRCTool />, document.getElementById('root'));
    </script>
</body>
</html>
